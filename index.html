<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>è‡´é˜¿ä½³</title>
    <link href="https://fonts.googleapis.com/css2?family=Ma+Shan+Zheng&family=Montserrat:wght@300;500&display=swap" rel="stylesheet">
    <style>
        /* --- 1. å…¨å±€é…ç½® --- */
        body, html {
            margin: 0; padding: 0; width: 100%; height: 100%;
            overflow: hidden; 
            background: radial-gradient(ellipse at bottom, #1b2735 0%, #090a0f 100%);
            font-family: 'Montserrat', 'Ma Shan Zheng', sans-serif;
            color: white;
        }

        /* ä¸¤ä¸ªCanvasï¼šä¸€ä¸ªç”»æ˜Ÿæ˜Ÿï¼Œä¸€ä¸ªç”»çˆ±å¿ƒ */
        #starCanvas, #heartCanvas {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%; 
            pointer-events: none;
        }
        #starCanvas { z-index: 1; }
        #heartCanvas { z-index: 2; }

        /* --- 2. é®ç½©å±‚ --- */
        #overlay {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.92); z-index: 999;
            display: flex; justify-content: center; align-items: center;
            transition: opacity 1.5s ease-in-out;
        }
        .enter-btn {
            padding: 12px 35px; border: 1px solid rgba(255,153,172,0.5);
            background: rgba(255,153,172,0.1); color: #ffccd5; 
            font-size: 1.1rem; cursor: pointer; letter-spacing: 2px; border-radius: 50px;
            transition: all 0.5s; box-shadow: 0 0 20px rgba(255, 153, 172, 0.2);
            animation: pulseBtn 2s infinite;
        }
        .enter-btn:hover {
            background: rgba(255,153,172,0.3); transform: scale(1.05);
            box-shadow: 0 0 30px rgba(255, 153, 172, 0.6);
        }

        /* --- 3. ä¸»è¦å†…å®¹åŒº --- */
        #main-content {
            position: absolute; top: 45%; left: 50%; /*ç¨å¾®å¾€ä¸Šæä¸€ç‚¹ï¼Œç»™æ­Œè¯ç•™ä½ç½®*/
            transform: translate(-50%, -50%);
            width: 85%; max-width: 550px;
            z-index: 10; text-align: center;
            opacity: 0; transition: opacity 2s ease;
        }
        
        .timer-label { font-size: 1rem; color: #aab; margin-bottom: 10px; letter-spacing: 2px; }
        .timer-box {
            font-family: 'Montserrat', sans-serif;
            font-size: 1.2rem; color: #eef; margin-bottom: 30px;
            text-shadow: 0 0 10px rgba(100, 200, 255, 0.6);
        }
        .timer-highlight { color: #ff99ac; font-weight: bold; font-size: 1.6rem; margin: 0 4px; }

        .typewriter {
            font-size: 1.25rem; line-height: 1.8;
            text-align: left; color: #f0f0f0;
            text-shadow: 0 0 2px rgba(255,255,255,0.3);
            background: rgba(255, 255, 255, 0.05);
            padding: 25px; border-radius: 15px;
            border: 1px solid rgba(255,255,255,0.05);
            backdrop-filter: blur(4px);
            min-height: 250px;
        }
        
        .cursor { display: inline-block; width: 2px; height: 1.2rem; background: #ff99ac; animation: blink 1s infinite; vertical-align: middle; }
        .signature { margin-top: 25px; font-size: 0.9rem; color: #889; text-align: right; opacity: 0; transition: opacity 1.5s; }

        /* --- 4. æ­Œè¯å±•ç¤ºåŒº --- */
        #lyric-container {
            position: fixed; bottom: 30px; left: 0; width: 100%;
            text-align: center; z-index: 20;
            pointer-events: none;
        }
        #lyric-text {
            font-size: 1.1rem; color: #ffccd5;
            text-shadow: 0 0 5px rgba(255, 100, 150, 0.8);
            font-family: 'Ma Shan Zheng', cursive;
            transition: opacity 0.3s ease; opacity: 0.8;
            padding: 0 20px;
        }

        /* éŸ³ä¹æŒ‰é’® */
        #music-control {
            position: fixed; top: 20px; right: 20px; z-index: 100;
            opacity: 0.6; cursor: pointer; transition: all 0.3s;
            background: rgba(0,0,0,0.3); border-radius: 50%; padding: 8px;
        }
        #music-control:hover { opacity: 1; background: rgba(0,0,0,0.5); }
        .spin { animation: spin 4s linear infinite; }

        @keyframes pulseBtn { 0% { opacity: 0.8; } 50% { opacity: 1; } 100% { opacity: 0.8; } }
        @keyframes blink { 0%, 100% { opacity: 1; } 50% { opacity: 0; } }
        @keyframes spin { 100% { transform: rotate(360deg); } }
        
        @media (max-width: 768px) {
            .typewriter { font-size: 1.1rem; padding: 20px; }
            #lyric-text { font-size: 1rem; bottom: 20px; }
        }
    </style>
</head>
<body>

    <audio id="bgm" loop>
        <source src="æƒŸçˆ±ä½ .mp3" type="audio/mpeg">
    </audio>

    <div id="music-control" onclick="toggleMusic()">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#ff99ac" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="10"></circle>
            <polygon points="10 8 16 12 10 16 10 8" fill="#ff99ac"></polygon>
        </svg>
    </div>

    <canvas id="starCanvas"></canvas>
    <canvas id="heartCanvas"></canvas>

    <div id="overlay">
        <button class="enter-btn" onclick="startJourney()">ç‚¹å‡»å¼€å¯å±äºæˆ‘ä»¬çš„æ˜Ÿæ²³</button>
    </div>

    <div id="main-content">
        <div class="timer-label">æˆ‘ä»¬ç›¸è¯†å·²ç»</div>
        <div class="timer-box">
            <span id="days" class="timer-highlight">0</span> å¤© 
            <span id="hours" class="timer-highlight">0</span> æ—¶ 
            <span id="minutes" class="timer-highlight">0</span> åˆ† 
            <span id="seconds" class="timer-highlight">0</span> ç§’
        </div>

        <div class="typewriter">
            <span id="text-target"></span><span class="cursor"></span>
        </div>

        <div class="signature" id="signature"></div>
    </div>

    <div id="lyric-container">
        <div id="lyric-text">â™ª ç­‰å¾…éŸ³ä¹æ’­æ”¾...</div>
    </div>

    <script>
        // ==========================================
        // ğŸ‘‡ 1. è¿™é‡Œå¡«å…¥ä½ çš„ LRC æ­Œè¯ (ä¿ç•™æ ¼å¼)
        // ==========================================
        const LRC_CONTENT = `
[00:16.76]ä¹Ÿè®¸è¿™å°±æ˜¯å®¿å‘½
[00:19.38]æˆ‘å¬è§äº†è¿™æ ·çš„ä½ 
[00:24.04]æ‹¥æœ‰æ²‰é»˜çš„åä¸½
[00:26.7]åƒä¸€é¢—é¥è¿œçš„æ’æ˜Ÿ
[00:30.76]é‚£äº›å­¤å•çš„å¤œé‡Œ
[00:34.43]æ™šæ­Œè¦ç»•åœ¨å¿ƒåº•
[00:38.0]å¤šæƒ³äº²å£å‘Šè¯‰ä½ 
[00:41.48]ä½ æ˜¯æˆ‘å¿ƒé‡Œçš„æƒŸä¸€
[00:45.3]æƒŸçˆ±ä½ 
[00:46.92]ä½ çš„å£°éŸ³æ˜¯å¹¸ç¦çš„åŠ¨åŠ›
[00:51.59]æƒŸçˆ±ä½ 
[00:53.52]æƒ³ç€ä½ å¿ƒé‡Œå°±å¤šä¸€ç‰‡å…‰æ˜
[00:58.88]æƒŸçˆ±ä½ 
[01:00.75]ä¸è®ºä¸€è·¯ç»å†å†å¤§æš´é£é›¨
[01:06.64]æˆ‘ä¼šæ°¸è¿œåšå®šé™ªç€ä½ 
[01:29.44]ä¹Ÿè®¸è¿™å°±æ˜¯å®¿å‘½
[01:32.130005]æˆ‘å¬è§äº†è¿™æ ·çš„ä½ 
[01:36.68]æ‹¥æœ‰æ²‰é»˜çš„åä¸½
[01:39.44]åƒä¸€é¢—é¥è¿œçš„æ’æ˜Ÿ
[01:43.509995]é‚£äº›å­¤å•çš„å¤œé‡Œ
[01:47.21]æ™šæ­Œè¦ç»•åœ¨å¿ƒåº•
[01:50.740005]å¤šæƒ³äº²å£å‘Šè¯‰ä½ 
[01:54.31]ä½ æ˜¯æˆ‘å¿ƒé‡Œçš„æƒŸä¸€
[01:58.43]æƒŸçˆ±ä½ 
[01:59.81]ä½ çš„å£°éŸ³æ˜¯å¹¸ç¦çš„åŠ¨åŠ›
[02:04.37]æƒŸçˆ±ä½ 
[02:06.19]æƒ³ç€ä½ å¿ƒé‡Œå°±å¤šä¸€ç‰‡å…‰æ˜
[02:11.57]æƒŸçˆ±ä½ 
[02:13.45]ä¸è®ºä¸€è·¯ç»å†å†å¤§æš´é£é›¨
[02:19.44]æˆ‘ä¼šæ°¸è¿œåšå®šé™ªç€ä½ 
[02:27.58]ä¸€åœºç¾ä¸½çš„çƒŸèŠ±é›¨
[02:30.82]æˆ‘å¾®ç¬‘ç€å†™è¿›æ—¥è®°
[02:34.41]æˆ‘ä¸ä¼šå¿˜è®°
[02:37.75]ä½ å‡ºç°åœ¨æˆ‘ç”Ÿå‘½
[02:41.69]æƒŸçˆ±ä½ 
[02:43.28]ä½ çš„å£°éŸ³æ˜¯å¹¸ç¦çš„åŠ¨åŠ›
[02:47.94]æƒŸçˆ±ä½ 
[02:49.88]æƒ³ç€ä½ å¿ƒé‡Œå°±å¤šä¸€ç‰‡å…‰æ˜
[02:55.25]æƒŸçˆ±ä½ 
[02:57.1]ä¸è®ºä¸€è·¯ç»å†å†å¤§æš´é£é›¨
[03:03.04]æˆ‘ä¼šæ°¸è¿œåšå®šé™ªç€ä½ 
`;

        // ==========================================
        // ğŸ‘‡ 2. æ ¸å¿ƒé…ç½®åŒº
        // ==========================================
        const CONFIG = {
            startDate: "2025-09-05 02:51:00", 
            loveText: `é˜¿ä½³å®å®ï¼š

æ•…äº‹çš„ä¼ç¬”ï¼Œå…¶å®åŸ‹å¾—å¾ˆæ—©ã€‚
æ—©å·²è®°ä¸æ¸…æ˜¯å“ªå¤©è¢«ä½ çš„å£°éŸ³å¸å¼•ï¼Œ
ï¼ˆæ¯•ç«Ÿæˆ‘æ˜¯ä¸ªæåº¦å£°æ§ï¼ï¼‰
åªè®°å¾—6æœˆ1æ—¥é‚£å¤©ï¼Œ
æˆ‘é¼“èµ·å‹‡æ°”å‘å‡ºäº†ç¬¬ä¸€æ¡ç§ä¿¡ã€‚

å§‹äºå£°éŸ³ï¼Œé™·äºå¿ƒåŠ¨ã€‚

ä½†æˆ‘çœŸæ­£çš„æ—¶é—´ï¼Œ
æ˜¯ä»2025å¹´9æœˆ5æ—¥ 02:51 å¼€å§‹è®¡ç®—çš„ã€‚
é‚£æ˜¯ä½ ç¬¬ä¸€æ¬¡å›å¤æˆ‘ï¼Œ
ä¹Ÿæ˜¯æˆ‘ä»¬çœŸæ­£ç›¸è¯†çš„èµ·ç‚¹ã€‚
é‚£ä¸€åˆ»ï¼Œæ·±å¤œçš„ç­‰å¾…ç»ˆäºæœ‰äº†å›å“ã€‚

æˆ‘æƒ³åˆ†åˆ†ç§’ç§’é™ªåœ¨ä½ èº«è¾¹ï¼Œ
ç›´åˆ°æ—¶é—´å°½å¤´ï¼Œæˆ–è€…ç›´åˆ°ä½ è…»çš„é‚£å¤©ã€‚

æ­¤åˆ»ï¼Œè¿™æ¼«å¤©æ˜Ÿæ²³ï¼Œ
çš†æ˜¯æˆ‘ä¸ºä½ è·³åŠ¨çš„å¿ƒã€‚
é˜¿ä½³ï¼Œä½ çœ‹åˆ°äº†å—ï¼Ÿ`,
            signature: "â€”â€” æ°¸è¿œå®ˆæŠ¤ä½ çš„ è¥¿ç“œ~" // è®°å¾—æ”¹åå­—
        };

        // ==========================================
        //    ä»¥ä¸‹é€»è¾‘æ— éœ€ä¿®æ”¹
        // ==========================================

        document.getElementById('signature').innerText = CONFIG.signature;
        const audio = document.getElementById('bgm');
        const musicIcon = document.querySelector('#music-control svg');
        let isPlaying = false;
        let heartRainStarted = false; // çˆ±å¿ƒé›¨å¼€å…³

        // --- æ­Œè¯è§£æä¸åŒæ­¥ ---
        const lyrics = parseLrc(LRC_CONTENT);
        const lyricDisplay = document.getElementById('lyric-text');

        function parseLrc(lrc) {
            const lines = lrc.split('\n');
            const result = [];
            for (let line of lines) {
                const match = line.match(/\[(\d+):(\d+)(\.\d+)?\](.*)/);
                if (match) {
                    const t = parseInt(match[1]) * 60 + parseInt(match[2]) + (match[3] ? parseFloat(match[3]) : 0);
                    result.push({ time: t, text: match[4].trim() });
                }
            }
            return result;
        }

        audio.addEventListener('timeupdate', () => {
            const ct = audio.currentTime;
            for (let i = lyrics.length - 1; i >= 0; i--) {
                if (ct >= lyrics[i].time) {
                    if (lyricDisplay.innerText !== lyrics[i].text) {
                        lyricDisplay.style.opacity = 0;
                        setTimeout(() => {
                            lyricDisplay.innerText = lyrics[i].text || "â™ª";
                            lyricDisplay.style.opacity = 0.8;
                        }, 100);
                    }
                    break;
                }
            }
        });

        // --- å¯åŠ¨é€»è¾‘ ---
        function startJourney() {
            const overlay = document.getElementById('overlay');
            const mainContent = document.getElementById('main-content');
            
            audio.play().then(() => {
                isPlaying = true;
                musicIcon.classList.add('spin');
            }).catch(() => {});

            overlay.style.opacity = 0;
            setTimeout(() => {
                overlay.style.display = 'none';
                mainContent.style.opacity = 1;
                typeWriter();
            }, 1500);
        }

        function toggleMusic() {
            if (isPlaying) { audio.pause(); musicIcon.classList.remove('spin'); } 
            else { audio.play(); musicIcon.classList.add('spin'); }
            isPlaying = !isPlaying;
        }

        // --- è®¡æ—¶å™¨ ---
        function updateTimer() {
            const diff = new Date().getTime() - new Date(CONFIG.startDate).getTime();
            if (diff < 0) { document.getElementById('seconds').innerText = "0"; return; }
            document.getElementById('days').innerText = Math.floor(diff / 86400000);
            document.getElementById('hours').innerText = Math.floor((diff % 86400000) / 3600000);
            document.getElementById('minutes').innerText = Math.floor((diff % 3600000) / 60000);
            document.getElementById('seconds').innerText = Math.floor((diff % 60000) / 1000);
        }
        setInterval(updateTimer, 1000);
        updateTimer();

        // --- æ‰“å­—æœº & è§¦å‘çˆ±å¿ƒ ---
        let charIndex = 0;
        const textTarget = document.getElementById('text-target');
        const speed = 120;

        function typeWriter() {
            if (charIndex < CONFIG.loveText.length) {
                const char = CONFIG.loveText.charAt(charIndex);
                textTarget.innerHTML += char === '\n' ? '<br>' : char;
                charIndex++;
                let delay = speed;
                if (['ï¼Œ', 'ã€‚', 'ï¼', 'ï¼Ÿ', '\n'].includes(char)) delay = speed * 2.5;
                setTimeout(typeWriter, delay);
            } else {
                document.getElementById('signature').style.opacity = 1;
                // æ‰“å­—ç»“æŸï¼Œå¼€å¯æ»¡å±çˆ±å¿ƒ
                setTimeout(() => { heartRainStarted = true; }, 1000);
            }
        }

        // ==========================================
        //  ğŸŒ  ç»˜å›¾åŒºï¼šæ˜Ÿæ˜Ÿ + çˆ±å¿ƒ
        // ==========================================
        const starCanvas = document.getElementById('starCanvas');
        const heartCanvas = document.getElementById('heartCanvas');
        const sCtx = starCanvas.getContext('2d');
        const hCtx = heartCanvas.getContext('2d');
        let width, height;
        let stars = [];
        let hearts = [];

        function initDims() {
            width = window.innerWidth;
            height = window.innerHeight;
            starCanvas.width = heartCanvas.width = width;
            starCanvas.height = heartCanvas.height = height;
        }
        window.addEventListener('resize', initDims);
        initDims();

        // åˆå§‹åŒ–æ˜Ÿæ˜Ÿ
        for(let i = 0; i < 200; i++) {
            stars.push({
                x: Math.random() * width, y: Math.random() * height,
                r: Math.random() * 1.5,
                dx: (Math.random() - 0.5) * 0.4, dy: (Math.random() - 0.5) * 0.4,
                alpha: Math.random(), fade: (Math.random() * 0.02) + 0.005
            });
        }

        // çˆ±å¿ƒç±»
        class Heart {
            constructor() {
                this.x = Math.random() * width;
                this.y = height + 10;
                this.size = Math.random() * 10 + 5;
                this.speedY = Math.random() * 1.5 + 0.5;
                this.color = `rgba(255, ${Math.floor(Math.random() * 100 + 150)}, ${Math.floor(Math.random() * 100 + 150)},`; 
                this.opacity = 1;
            }
            update() {
                this.y -= this.speedY;
                this.opacity -= 0.002;
            }
            draw() {
                hCtx.fillStyle = this.color + this.opacity + ')';
                hCtx.beginPath();
                let top = this.size * 0.3;
                // ç”»å¿ƒå½¢
                hCtx.moveTo(this.x, this.y + top);
                hCtx.bezierCurveTo(this.x, this.y, this.x - this.size / 2, this.y, this.x - this.size / 2, this.y + top);
                hCtx.bezierCurveTo(this.x - this.size / 2, this.y + (this.size + top) / 2, this.x, this.y + (this.size + top) / 2 + top, this.x, this.y + this.size);
                hCtx.bezierCurveTo(this.x, this.y + (this.size + top) / 2 + top, this.x + this.size / 2, this.y + (this.size + top) / 2, this.x + this.size / 2, this.y + top);
                hCtx.bezierCurveTo(this.x + this.size / 2, this.y, this.x, this.y, this.x, this.y + top);
                hCtx.fill();
            }
        }

        function animate() {
            // 1. ç”»æ˜Ÿæ˜Ÿ
            sCtx.clearRect(0, 0, width, height);
            stars.forEach(star => {
                sCtx.beginPath();
                sCtx.shadowBlur = 4; sCtx.shadowColor = "rgba(255,255,255,0.8)";
                sCtx.fillStyle = `rgba(255, 255, 255, ${star.alpha})`;
                sCtx.arc(star.x, star.y, star.r, 0, Math.PI * 2);
                sCtx.fill();
                star.x += star.dx; star.y += star.dy;
                star.alpha -= star.fade;
                if (star.alpha <= 0 || star.alpha >= 1) star.fade = -star.fade;
                if(star.x < 0) star.x = width; if(star.x > width) star.x = 0;
                if(star.y < 0) star.y = height; if(star.y > height) star.y = 0;
            });

            // 2. ç”»çˆ±å¿ƒ (å¦‚æœå¼€å¯)
            hCtx.clearRect(0, 0, width, height);
            if (heartRainStarted) {
                if (Math.random() < 0.1) hearts.push(new Heart()); // ç”Ÿæˆæ–°çˆ±å¿ƒ
                for (let i = 0; i < hearts.length; i++) {
                    hearts[i].update();
                    hearts[i].draw();
                    if (hearts[i].y < -20 || hearts[i].opacity <= 0) {
                        hearts.splice(i, 1); i--;
                    }
                }
            }
            requestAnimationFrame(animate);
        }
        animate();
    </script>
</body>
</html>
